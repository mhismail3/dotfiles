{"_meta":{"id":"9f2a3b4c-5d6e-7f8g-9h0i-1j2k3l4m5n6o","ts":"2025-12-28T18:45:00Z","v":1},"front":{"project":"claude-research","path":"/Users/moose/Downloads/projects/claude-research","title":"Custom Claude Agent Harness Research","type":"research","status":"completed","tags":["agent-harness","claude-code","opencode","pi","mcp","tool-calling","api"]},"body":{"agent":{"model":"claude-opus-4-5-20251101","tool":"claude-code"},"git":{"branch":"main","commit":"9472fc8"},"input":"Research what goes into creating custom agent harness like OpenCode or Pi for Claude models with full visibility/control, filesystem access, using Max plan","actions":["Researched OpenCode, Pi, and Claude Code architectures","Investigated Max plan vs API authentication methods","Analyzed tool calling implementation patterns","Researched MCP protocol and server implementation","Investigated sandboxing approaches (Docker, gVisor, OS-level)","Analyzed system prompt engineering best practices","Compiled 1100+ line comprehensive research report"],"files":[{"path":"sandboxes/agent-harness-research/README.md","op":"C","lines":"+20","why":"Research sandbox setup"},{"path":"reports/2025-12-28_custom-claude-agent-harness.md","op":"C","lines":"+1144","why":"Comprehensive research report"}],"decisions":[{"choice":"Structure report with implementation roadmap","alts":["Pure theoretical overview","Scattered notes"],"reason":"User wants actionable guidance for building their own harness"},{"choice":"Include complete code examples","alts":["Just conceptual descriptions"],"reason":"User specifically wants to know EVERYTHING about implementation"}],"lessons":["claude_max project shows Max subscription can be used programmatically by unsetting ANTHROPIC_API_KEY","Pi demonstrates minimal approach (4 tools, <1K system prompt) matches complex harnesses","Core agent pattern is simple while loop with tool handling","MCP uses JSON-RPC 2.0 with stdio or HTTP transport","Claude Agent SDK provides production-ready harness with compaction","Sandboxing requires both filesystem AND network isolation"]},"history":{"embedded":false,"ref":"ledger-context/sessions/2025-12-28_claude-research_agent-harness.md"}}
